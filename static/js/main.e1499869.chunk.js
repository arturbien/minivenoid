(this["webpackJsonpthree-react-test"]=this["webpackJsonpthree-react-test"]||[]).push([[0],{12:function(t){t.exports=JSON.parse('{"cards":[{"id":"34249","position":[-1000,-800,0],"height":270,"width":120,"exits":[{"id":"99211"},{"id":"90412"},{"id":"55389"}]},{"id":"78579","position":[-1250,-650,1e-10],"height":282,"width":120,"exits":[{"id":"17207"}]},{"id":"39227","position":[-600,-1750,2e-10],"height":130,"width":120,"exits":[{"id":"14024"},{"id":"59362"},{"id":"45730"}],"variant":"solution"},{"id":"1635","position":[-800,-1200,7.000000000000001e-10],"height":256,"width":120,"exits":[{"id":"8855"},{"id":"17317"}]},{"id":"52280","position":[-800,-1750,8e-10],"height":271,"width":120,"exits":[{"id":"75480"},{"id":"99666"},{"id":"59186"}]},{"id":"23949","position":[-1000,-1450,9e-10],"height":223,"width":120,"exits":[{"id":"9233"},{"id":"97253"},{"id":"58931"}]},{"id":"25343","position":[-800,-900,1e-9],"height":111,"width":120,"exits":[{"id":"3510"},{"id":"66947"}]},{"id":"26875","position":[-600,-1200,1.1000000000000001e-9],"height":272,"width":120,"exits":[{"id":"28193"},{"id":"56005"},{"id":"69383"}],"variant":"solution"},{"id":"56765","position":[-1000,-1050,1.2e-9],"height":209,"width":120,"exits":[{"id":"98472"}]},{"id":"69723","position":[-800,-550,1.3e-9],"height":148,"width":120,"exits":[{"id":"16583"}],"variant":"solution"},{"id":"29498","position":[-600,-1600,1.4000000000000001e-9],"height":137,"width":120,"exits":[],"variant":"solution"},{"id":"60889","position":[-600,-900,1.5e-9],"height":207,"width":120,"exits":[{"id":"26226"},{"id":"66099"},{"id":"25984"}],"variant":"solution"},{"id":"24250","position":[-200,-1400,1.6e-9],"height":255,"width":120,"exits":[{"id":"4175"},{"id":"28086"},{"id":"78042"}]},{"id":"60129","position":[-1250,-950,1.7000000000000001e-9],"height":209,"width":120,"exits":[{"id":"25652"}]}],"connections":[{"id":"51704","from":"3510","to":"60889"},{"id":"48234","from":"9233","to":"52280"},{"id":"35226","from":"66099","to":"24250"},{"id":"89173","from":"59186","to":"29498"},{"id":"56173","from":"90412","to":"69723"},{"id":"1090","from":"97253","to":"24250"},{"id":"3342","from":"25652","to":"56765"},{"id":"62065","from":"25652","to":"34249"},{"id":"88162","from":"17207","to":"69723"},{"id":"89790","from":"14024","to":"24250"},{"id":"9594","from":"8855","to":"26875"},{"id":"69088","from":"8855","to":"60889"},{"id":"12181","from":"75480","to":"39227"},{"id":"58568","from":"17207","to":"34249"}]}')},13:function(t,n,e){},14:function(t,n,e){"use strict";e.r(n);var i=e(1),o=e(2),r=e(0),a=e.n(r),c=e(5),u=e.n(c),d=e(3),m={zoom:0,position:[0,0]},l=a.a.createContext({zoom:0,position:[0,0]}),s=a.a.createContext((function(){throw new Error("Cannot set camera")})),h=a.a.createContext({current:null}),f=function(){return a.a.useContext(h)},v=function(t){return Math.exp(t)},p=function(t){document.documentElement.style.cursor=t||null},g=function(t){return 50*Math.round(t/50)},M=function(t){return[g(t[0]),g(t[1])]},x=function(t){var n=t.children,e=a.a.useContext(l),i=e.zoom,o=e.position;return a.a.createElement("g",{transform:"\n          translate(\n            ".concat(document.documentElement.clientWidth/2,",\n            ").concat(document.documentElement.clientHeight/2,"\n          )\n          scale(").concat(v(i),")\n          translate(").concat(-o[0],", ").concat(o[1],")\n        ")},n)},E=e(6),w=function(t){var n=t.isConnected,e=t.variant,i=Object(E.a)(t,["isConnected","variant"]);return a.a.createElement("circle",Object.assign({r:10,stroke:n?"solution"===e?"#7f333e":"#3d3f4c":"#666666",fill:n?"solution"===e?"#7f333e":"#3d3f4c":"#FFFFFF",strokeWidth:3},i))},C=a.a.createContext({cardMap:new Map,connectionMap:new Map,cardFromExitMap:new Map,setCard:function(){throw new Error("Uninitialized context: Cannot set card")}}),b=function(t){var n=t.model,e=t.onSetModel,i=t.children,r=a.a.useMemo((function(){return new Map(n.cards.map((function(t){return[t.id,t]})))}),[n.cards]),c=a.a.useMemo((function(){return new Map(n.connections.map((function(t){return[t.id,t]})))}),[n.connections]),u=a.a.useMemo((function(){return new Map(n.cards.flatMap((function(t){return t.exits.map((function(n){return[n.id,t]}))})))}),[n.cards]),d=a.a.useCallback((function(t,n){return e((function(e){return Object(o.a)({},e,{cards:e.cards.map((function(e){return e.id===t?n(e):e}))})}))}),[e]);return a.a.createElement(C.Provider,{value:a.a.useMemo((function(){return{cardMap:r,connectionMap:c,cardFromExitMap:u,setCard:d}}),[r,c,u,d])},i)},y=function(){return a.a.useContext(C)},O=a.a.memo((function(t){var n=t.card,e=t.onChangeCard,r=f(),c=function(t){return e(n.id,(function(n){return Object(o.a)({},n,{},"function"===typeof t?t(n):t)}))},u=Object(d.a)({onClick:function(t){var n=t.event,e=n.ctrlKey,i=n.altKey;e?c({height:20+400*Math.random()}):i&&c((function(t){return{variant:"solution"===t.variant?void 0:"solution"}}))},onDragStart:function(){p("grabbing")},onDragEnd:function(t){var n,e,o=Object(i.a)(t.movement,2),a=o[0],u=o[1],d=t.memo;if(p(),d){var m=v(null!==(n=null===(e=r.current)||void 0===e?void 0:e.zoom)&&void 0!==n?n:0);c({position:M([d[0]+a/m,d[1]+u/m])})}},onDrag:function(t){var e,o,a=t.buttons,u=Object(i.a)(t.movement,2),d=u[0],m=u[1],l=t.memo;if(1===a){p("grabbing"),l||(l=n.position);var s=v(null!==(e=null===(o=r.current)||void 0===o?void 0:o.zoom)&&void 0!==e?e:0);return c({position:[l[0]+d/s,l[1]+m/s]}),l}}},{pointerEvents:!0,drag:{threshold:10}});return a.a.createElement(a.a.Fragment,null,a.a.createElement("g",{transform:"translate(".concat(n.position[0],", ").concat(n.position[1],")")},a.a.createElement("rect",Object.assign({width:n.width,height:n.height,fill:"solution"===n.variant?"#7f333e":"#3d3f4c",rx:10},u())),a.a.createElement(w,{isConnected:!0,variant:n.variant,cy:n.height/2}),n.exits.map((function(t,e){return a.a.createElement(w,{key:t.id,isConnected:!0,variant:n.variant,cx:n.width,cy:n.height*(1+e)/(1+n.exits.length)})}))))})),j=function(){var t=y(),n=t.cardMap,e=t.setCard;return a.a.createElement("g",{id:"cards"},Array.from(n.values()).map((function(t){return a.a.createElement(O,{key:t.id,card:t,onChangeCard:e})})))},k=a.a.memo((function(t){var n=t.connection,e=t.fromCard,i=t.toCard,o=e.exits.findIndex((function(t){return t.id===n.from})),r=[e.position[0]+e.width,e.position[1]+e.height*(1+o)/(e.exits.length+1)],c=[i.position[0],i.position[1]+i.height/2],u=Math.abs((c[0]-r[0])/2),d=Math.max(50,u);return a.a.createElement("path",{d:"\n        M ".concat(r[0]," ").concat(r[1],"\n        C ").concat(r[0]+d," ").concat(r[1]," ").concat(c[0]-d," ").concat(c[1]," ").concat(c[0]," ").concat(c[1],"\n      "),fill:"none",strokeWidth:4,stroke:"solution"===i.variant?"#7f333e":"#3d3f4c"})})),z=function(){var t=y(),n=t.connectionMap,e=t.cardMap,i=t.cardFromExitMap;return a.a.createElement("g",{id:"connections"},Array.from(n.values()).map((function(t){var n=i.get(t.from),o=e.get(t.to);return n&&o?a.a.createElement(k,{key:t.id,connection:t,fromCard:n,toCard:o}):null})))},F=function(){return Math.floor(1e7*Math.random()).toString()},S=function(){var t=new URLSearchParams(window.location.search);if("1"===t.get("model"))return e(12);var n,i=parseInt(null!==(n=t.get("amt"))&&void 0!==n?n:"")||50;return function(t,n){var e=new Array(t).fill(null).map((function(n,e){return{id:F(),position:M([(.5-Math.random())*Math.sqrt(t)*1e3,(.5-Math.random())*Math.sqrt(t)*1e3]),height:Math.round(200*(.5+Math.random())),width:120,variant:Math.random()>.8?"solution":void 0,exits:new Array(Math.floor(4*Math.random())).fill(null).map((function(t){return{id:F()}}))}})),i=e.flatMap((function(t){return t.exits})),o=new Array(Math.round(n)).fill(0).map((function(){return{id:F(),from:i[Math.max(0,Math.floor(Math.random()*i.length-1))].id,to:e[Math.max(0,Math.floor(Math.random()*e.length-1))].id}}));return{cards:e,connections:o}}(i,.8*i)}();e(13);u.a.render(a.a.createElement((function(t){var n=t.children,e=a.a.useState(S),o=Object(i.a)(e,2),r=o[0],c=o[1];return a.a.createElement(b,{model:r,onSetModel:c},n)}),null,a.a.createElement((function(t){var n=t.children,e=a.a.useState(m),o=Object(i.a)(e,2),r=o[0],c=o[1],u=a.a.useRef(m),d=a.a.useCallback((function(t){c(t),u.current=t}),[]);return a.a.createElement(l.Provider,{value:r},a.a.createElement(s.Provider,{value:d},a.a.createElement(h.Provider,{value:u},n)))}),null,a.a.createElement((function(){var t=f(),n=a.a.useContext(s),e=a.a.useRef(null),r=y().cardMap;return a.a.useEffect((function(){var t,e={minX:(t=Array.from(r.values())).reduce((function(t,n){return Math.min(t,n.position[0])}),1/0),maxX:t.reduce((function(t,n){return Math.max(t,n.position[0]+n.width)}),-1/0),minY:t.reduce((function(t,n){return Math.min(t,n.position[1])}),1/0),maxY:t.reduce((function(t,n){return Math.max(t,n.position[1]+n.height)}),-1/0)};n({position:[(e.maxX+e.minX)/2,-(e.maxY+e.minY)/2],zoom:-Math.log(Math.max((e.maxY-e.minY+200)/document.documentElement.clientHeight,(e.maxX-e.minX+200)/document.documentElement.clientWidth))})}),[]),Object(d.a)({onWheel:function(e){var i=e.event,r=e.movement,a=e.memo;e.active;if(i){var c,u=0===i.deltaMode?1:20;if(!a)a=null===(c=t.current)||void 0===c?void 0:c.position;var d=v(t.current.zoom);return n(Object(o.a)({},t.current,{position:[r[0]/d*u+a[0],-r[1]/d*u+a[1]]})),a}},onPinch:function(e){var r=e.event,a=(e.origin,Object(i.a)(e.da,1)[0]),c=e.memo;r.preventDefault();var u=a/50;c||(c={delta:u,initZoom:t.current.zoom,initPos:t.current.position});var d=c.initZoom+u-c.delta;return n(Object(o.a)({},t.current,{zoom:d})),c},onDrag:function(e){var i=e.buttons,r=(e.active,e.movement),a=(e.direction,e.velocity,e.memo);if(4===i){a||(a=t.current.position);var c=v(t.current.zoom);return n(Object(o.a)({},t.current,{position:r.map((function(t,n){return t*c+a[n]}))})),a}},onDoubleClick:function(t){var n=t.event;n.clientX,n.clientY,n.ctrlKey}},{domTarget:e,eventOptions:{passive:!1}}),a.a.createElement("svg",{ref:e,viewBox:"0 0 ".concat(document.documentElement.clientWidth," ").concat(document.documentElement.clientHeight)},a.a.createElement(x,null,a.a.createElement(z,null),a.a.createElement(j,null)))}),null))),document.getElementById("root"))},7:function(t,n,e){t.exports=e(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.e1499869.chunk.js.map